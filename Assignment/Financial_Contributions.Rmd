## Exploration of Financial Contributions for the 2016 Presidential Campaign 

#### by Sim Virdi

***

## Abstract

This report explores a dataset containing approximately 437000 Financial Contributions to the 2016 Presidential Campaigns.

I retrieved US Zip Codes from this [website](https://www.gaslampmedia.com/download-zip-code-latitude-longitude-city-state-county-csv/).

## Dataset

```{r message=FALSE, warning=FALSE, packages}
# Load all of the packages that you end up using
# in your analysis in this code chunk.

# Notice that the parameter "echo" was set to FALSE for this code chunk.
# This prevents the code from displaying in the knitted HTML output.
# You should set echo=FALSE for all code chunks in your file.

library(ggplot2)
library(gridExtra)
library(RColorBrewer)
library(reshape2)
library(dplyr)
library(tidyr)
library(lubridate) # Might be needed for dates, See problem set 1
library(GGally)
library(scales)
library(memisc)
library(maps) # Needed for plotting NY State

```

```{r echo=FALSE, Load_the_Data}
# Load the Data
setwd("/Users/Sim/Desktop/Nanodegrees/Data Analyst/Task 4/Data Analysis with R/Assignment/")
data <- read.csv("NY_contributions.csv", row.names = NULL)
zips <- read.csv("zip_codes_states.csv")
parties <- read.csv("cand_gend_party.csv")

# Remove incorrect column from the dataset
colnames(data) <- c(colnames(data)[-1],"x")
data$x <- NULL

# Renaming columns in the data to be less verbose
data <- rename(data, c("contbr_city" = "city",
                       "contbr_st" = "st",
                       "contbr_zip" = "zip",
                       "contbr_employer" = "employer",
                       "contbr_occupation" = "occupation",
                       "contb_receipt_amt" = "amount",
                       "contb_receipt_dt" = "date"))

zips <- rename(zips, "zip_code" = "zip")

# Zipcodes need cleaning because majority are postal codes, only take first 5 characters
data$zip <- substr(data$zip, 0, 5)
data$zip <- ifelse(nchar(data$zip) < 4, 
                   NA,
                   data$zip)
#subset(data$zip, nchar(data$zip) < 4)
#unique(data$zip)

mdata <- merge(data, zips[, c("zip","latitude","longitude", "state")], by = "zip")
mdata <- merge(mdata, parties, by = "cand_nm")

# removing zip codes that aren't from NY state
mdata <- subset(mdata, mdata$state == "NY")

# Only interested in general and primary election from 2016
mdata <- subset(mdata, mdata$election_tp == "P2016" | mdata$election_tp == "G2016")

# remove redundant dataframes
remove(data, zips, parties)
```

***

## Univariate Plots Section

```{r echo=FALSE, Univariate_Plots}
dim(mdata)
str(mdata)
summary(mdata)
```

### Distribution in State

In the plot below, you can visualise the distribution of donations from NY State, however it is uneasy to see both the state and city boundaries. 
```{r echo=FALSE, warning=FALSE, Long_and_Lat}
# Plotting the long and lat of the donations
ggplot(aes(x = longitude, y = latitude), 
       data = subset(mdata, 
                     !is.na(mdata$zip))) +
  geom_point()
```

To make the boundaries clearer, I used the following [tutorial](https://uchicagoconsulting.wordpress.com/tag/r-ggplot2-maps-visualization/). 

From the plot, you can see that the largest cities have the highest frequency of contributions.
```{r echo=FALSE, warning=FALSE, Map_of_New_York}
# Choosing new york state
all_states <- map_data("state")
newyork <- subset(all_states, region %in% "new york")

# remove redundant dataframes
remove(all_states)

# Drawing silouhette of NY with contributor data points
ggplot() +
  geom_polygon(data = newyork,
               aes(x = long, y = lat, group = group)) +
  geom_jitter(aes(x = longitude, y = latitude, group = NULL), 
             data = subset(mdata, 
                     !is.na(mdata$zip)),
             alpha = 1/50,
             color = "coral1") +
  geom_point(data = subset(us.cities,
                           us.cities$country == "NY" & us.cities$pop > 100000),
             aes(x = long, y = lat, size = pop),
             colour = "green") +
  geom_text(data = subset(us.cities,
                          us.cities$country == "NY" & us.cities$pop > 100000),
            aes(x = long, y = lat, label = name),
            colour = "gold",
            fontface="bold")
```


### Amount Contributed

The next plot is used to visualise the amount of money being contributed. 

From the plot, you can see there are negative amounts being displayed due to refunds (we will explore them in further detail later).

```{r echo=FALSE, warning=FALSE, Amounts_with_refunds}
# Plot with refunds
qplot(x = amount, data = mdata) +
  scale_x_continuous(limits = c(-400, 400), breaks = seq(-400,400,50))

dim(subset(mdata, mdata$amount < 0))

# Summary with refunds.
summary(mdata$amount)

```

After removing the refunds, we see a positive skew in the distribution, with most of the money contributed between $15-$100. The median contribution is 27 with an IQR of 85. The mean is quite heavily skewed (due to v. large contributions).

```{r echo=FALSE, warning=FALSE, Amounts_without_refunds}
# Plot without refunds
qplot(x = amount, data = subset(mdata, amount >= 0)) +
  scale_x_continuous(limits = c(0, 400), breaks = seq(0,400,20))

# Summary without refunds.
summary(subset(mdata$amount, mdata$amount >= 0))
```

With the amount transformed using log10, we can see a normal distrubiton with a peak at 27.

```{r echo=FALSE, warning=FALSE, Amounts_transformed_with_log_without_refunds}
# Log transformed 
ggplot(aes(amount),
       data = subset(mdata, amount > 0)) +
  geom_histogram() +
  scale_x_continuous(trans = log10_trans(),
                     limits = c(1, 10000),
                     breaks = c(0, 10, 100, 500, 1000, 10000)) 
```

### Contributions by Gender

We are now exploring contribution amounts by gender. 

As can be seen in the histograms, both distributions have a very similar shape (both had a positive skew) with the male category having a higher frequency of contributions at $30 & $50.

From the summaries and boxplots respectively, we can see that Females have a larger mean and median contribution amount. Females also have anomalies at higher amounts.

From the frequency polygon, we get a clearer picture about the different amounts contributed to gender with females only having higher contributions at $20 and $70.
```{r echo=FALSE, warning=FALSE, Contributions_by_Gender}
# Histogram wrapped by gender
qplot(x = amount, data = subset(mdata, amount >= 0)) +
  scale_x_continuous(limits = c(0, 200), breaks = seq(0,200,20)) +
  facet_wrap(~gender)

table(mdata$gender)
by(mdata$amount, mdata$gender, summary)

# Boxplots
qplot(x = gender, y = log10(amount),
      data = subset(mdata, amount > 0),
      geom = 'boxplot')

# Frequency Plot
qplot(x = amount, y = ..count..,
      data = subset(mdata,  amount > 0), 
      xlab = 'Amount Contributed',
      ylab = 'Frequency',
      binwidth = 10, 
      geom = 'freqpoly', 
      color = gender) + 
  scale_x_continuous(lim = c(0, 200), breaks = seq(0, 200, 20)) 
```

### Contributions by Candidate

We are now exploring contribution amounts by candidate. 

As can be seen in the histograms, there is great variance in the distributions once transformed using log.

From the summaries, we can see that Bernie Sanders and Hilary Clinton have the frequency of contributions.

From the boxplots, we can see that Hilary Clinton has the greatest value of outliers and that the medians of all the candidates vary greatly.

```{r echo=FALSE, warning=FALSE, Contributions_by_Candidate}
# Histogram wrapped by candidate
qplot(x = amount, data = subset(mdata, amount >= 0)) +
  scale_x_continuous(limits = c(0, 200), breaks = seq(0,200,20)) +
  scale_x_log10() +
  facet_wrap(~cand_nm, scales ="free")

table(mdata$cand_nm)
by(mdata$amount, mdata$cand_nm, summary)

# Boxplots
qplot(x = cand_nm, y = log10(amount),
      data = subset(mdata, amount > 0),
      geom = 'boxplot') +
  theme(axis.text.x=element_text(size=6), legend.position = "none")
```

### Contributions by Party

We are now exploring contribution amounts by Party. 

From the histogram, we can determine that the plots all have similar shapes with a positive skew. 

From the Frequency polygon, we can see that the Democratic party has significantly more contributions than the Republicans (7.37 times more) and the Green party (1585 times more).

From the summaries and boxplot, we can see that the Democrats have the lowest median and mean (27, 191 respectively) of the 3 parties. The next highest medians are the Republicans with a median of 50 although they have the highest mean of 241.5. The green party has a median of 104.0 and a mean of 201.8 although they received significantly less contributions.

```{r echo=FALSE, warning=FALSE, Contributions_by_Party}
# Histogram wrapped by party
qplot(x = amount, data = subset(mdata, amount >= 0)) +
  scale_x_continuous(limits = c(0, 200), breaks = seq(0,200,20)) +
  facet_wrap(~party, scales = 'free')

# Frequency Plot
qplot(x = amount, y = ..count..,
      data = subset(mdata,  amount > 0), 
      xlab = 'Amount Contributed',
      ylab = 'Frequency',
      binwidth = 10, 
      geom = 'freqpoly', 
      color = party) + 
  scale_x_continuous(lim = c(0, 200), breaks = seq(0, 200, 20)) 

table(mdata$party)
by(mdata$amount, mdata$party, summary)

# Boxplots
qplot(x = party, y = log10(amount),
      data = subset(mdata, amount > 0),
      geom = 'boxplot')
```

## Univariate Analysis

### What is the structure of your dataset?
There are 428646 contributions in the dataset with 23 features. 

Observations:

* Most contributions are coming from heavily populated areas such as cities.
* The median contribution is $27 and max contribution is $4904860.51.
* Contributions are spread almost equally across gender.
* Most contributions go to the Democratic Party.
* Contributions mainly go to the same few candidates.

### What is/are the main feature(s) of interest in your dataset?
The main features in the dataset are amount, cand_nm and party. I'd like to determine which features influence whether a contribution is given.

### What other features in the dataset do you think will help support your investigation into your feature(s) of interest?
Gender, occupation, election_tp, zip and time will likely influence whether a contribution is given.

### Did you create any new variables from existing variables in the dataset?

### Of the features you investigated, were there any unusual distributions? Did you perform any operations on the data to tidy, adjust, or change the form of the data? If so, why did you do this?

I log transformed the amount of contribution for right skewed plots so it would be easier to see distributions. The distribution that I thought was most unusual was the contributions by party. I assumed that all parties would have a similar frequency of contributions however it turned out that the Democrats had almost 80% of contributions.

I adjusted column names to make them less verbose and removed rows that had data not related to the Primary or General 2016 elections or not within NY state. 

I inserted columns into the data to hold the longitude/latitude of zipcodes as well as gender and party of candidates. I did this so I could plot the contributions on a map over NY state and so that I could determine how the contributions were split between parties and gender of the candidates.

***

## Bivariate Plots Section

### Contributions by Zip

From the plot, it is clear that larger donations come from heavily populated areas.

```{r echo=FALSE}
# Drawing silouhette of NY with contributor data points
ggplot() +
  geom_polygon(data = newyork,
               aes(x = long, y = lat, group = group)) +
  geom_jitter(aes(x = longitude, y = latitude, group = NULL, color = amount), 
             data = subset(mdata, 
                     !is.na(mdata$zip))) +
  geom_point(data = subset(us.cities,
                           us.cities$country == "NY" & us.cities$pop > 100000),
             aes(x = long, y = lat, size = pop),
             colour = "green") +
  geom_text(data = subset(us.cities,
                          us.cities$country == "NY" & us.cities$pop > 100000),
            aes(x = long, y = lat, label = name),
            colour = "gold",
            fontface="bold")
```

### Contributions and Resignate/Refunds by Party

```{r echo=FALSE, Creating_table_for_party}
# Without Refunds
mdata.by_party <- subset(mdata, mdata$amount >= 0) %>%
  group_by(party) %>%
  summarise(amount_sum = sum(amount),
            amount_mean = mean(amount),
            amount_median = median(amount),
            n = n()) %>%
  arrange(amount_sum)

# With refunds
mdata.by_party_refunds <- subset(mdata, mdata$amount < 0) %>%
  group_by(party) %>%
  summarise(amount_sum = abs(sum(amount)),
            amount_mean = abs(mean(amount)),
            amount_median = abs(median(amount)),
            n = n()) %>%
  arrange(amount_sum)

merged_party <- merge(mdata.by_party, mdata.by_party_refunds, by=c("party"), all.x = TRUE)

# Renaming columns in the data to be more clear
merged_party <- rename(merged_party, 
                       c("amount_sum.x" = "c_amount_sum",
                       "amount_mean.x" = "c_amount_mean",
                       "amount_median.x" = "c_amount_median",
                       "n.x" = "c_count",
                       "amount_sum.y" = "r_amount_sum",
                       "amount_mean.y" = "r_amount_mean",
                       "amount_median.y" = "r_amount_median",
                       "n.y" = "r_count"))

# Higher the ratio the better
merged_party$total_ratio <- merged_party$c_amount_sum / merged_party$r_amount_sum
merged_party$count_ratio <- merged_party$c_count / merged_party$r_count
  
# Removing redundant dataframes
remove(mdata.by_party, mdata.by_party_refunds)
```

#### Contributions

From the various barcharts and tables below, you can see that the Democratic party had the highest amount of contributions (approx $75MM) followed by the Republicans (approx $15MM) and finally the Green party had the least amount (< $1MM).

The means of the contribution however were quite different, with the Democrats having the highest mean ($278) followed by the Green party ($201) and finally the Democrats ($195). This is a little misleading however as the Green party only had 238 contributions and so anomalies were more able to skew the data.

The medians of the contribution are a more robust metric and the Green party had the highest with $104, followed by the Republicans with $50 and finally the Democrats with $27.

As discussed earlier, the Democrats had almost 7.5 times as many contributions compared to the Republicans and over 1500 times more contributions than the Green party.

This data shows that the total contribution amount was greatest for the Democrats, however the Republicans received more money per contribution. **Does this suggest richer people donate to the Republicans?**

```{r echo=FALSE, Party_Contributions}
p1 <- ggplot(merged_party, aes(party, c_amount_sum, fill = party)) + 
  geom_bar(stat="identity") +
  xlab("Party") +
  ylab("Total Contributions") +
  ggtitle("2016 US Election Total Contribution by Party") +
  scale_y_continuous(breaks = seq(0, 80000000, 10000000))

p2 <- ggplot(merged_party, aes(party, c_amount_mean, fill = party)) + 
  geom_bar(stat="identity") +
  xlab("Party") +
  ylab("Mean Contribution") +
  ggtitle("2016 US Election Mean Contribution by Party")

p3 <- ggplot(merged_party, aes(party, c_amount_median, fill = party)) + 
  geom_bar(stat="identity") +
  xlab("Party") +
  ylab("Median Contribution") +
  ggtitle("2016 US Election Median Contribution by Party")

grid.arrange(p1,p2,p3, ncol=1)

merged_party[1:5]
```

#### Resignate/Refunds

From the various barcharts and tables below, you can see that the Republican party had the highest amount of refunds (approx $1.5MM) followed by the democrats (approx $1MM) and finally the Green party had none.

The means of the refunds followed this with the Republicans having the highest mean ($1224) followed by the Democrats ($297).

The medians of the refunds for the Republicans were highest at $484 followed by the Democrats at $100.

```{r echo=FALSE, Party_Refunds}
p1 <- ggplot(merged_party, aes(party, r_amount_sum, fill = party)) + 
  geom_bar(stat="identity") +
  xlab("Party") +
  ylab("Total Refunds") +
  ggtitle("2016 US Election Total Refunds by Party")

p2 <- ggplot(merged_party, aes(party, r_amount_mean, fill = party)) + 
  geom_bar(stat="identity") +
  xlab("Party") +
  ylab("Mean Refund") +
  ggtitle("2016 US Election Mean Refunds by Party")

p3 <- ggplot(merged_party, aes(party, r_amount_median, fill = party)) + 
  geom_bar(stat="identity") +
  xlab("Party") +
  ylab("Median Refund") +
  ggtitle("2016 US Election Median Refunds by Party")

grid.arrange(p1,p2,p3, ncol=1)

merged_party[c(1,6:9)]
```

#### Ratio of Resignate/Refunds to Contributions

From the barchart, we can see that the Ratio of contributions to refunds is greater for the Democrats than it is for the Republicans for both amount and frequency. 

```{r echo=FALSE, Party_Ratio}
p1 <- ggplot(merged_party, aes(party, total_ratio, fill = party)) + 
  geom_bar(stat="identity") +
  xlab("Party") +
  ylab("Ratio") +
  ggtitle("2016 US Election Ratio of Total Contribution to Refunds Amount by Party")

p2 <- ggplot(merged_party, aes(party, count_ratio, fill = party)) + 
  geom_bar(stat="identity") +
  xlab("Party") +
  ylab("Ratio") +
  ggtitle("2016 US Election Ratio of Number of Contribution to Refunds by Party")

grid.arrange(p1,p2, ncol=1)

merged_party[c(1,5,9,10:11)]
```


### Contributions and Resignate/Refunds by Candidate

```{r echo=FALSE, Creating_table_for_Candidates}
# Without Refunds
mdata.by_candidate <- subset(mdata, mdata$amount >= 0) %>%
  group_by(cand_nm, party) %>%
  summarise(amount_sum = sum(amount),
            amount_mean = mean(amount),
            amount_median = median(amount),
            n = n()) %>%
  arrange(amount_sum)

# With refunds
mdata.by_candidate_refunds <- subset(mdata, mdata$amount < 0) %>%
  group_by(cand_nm, party) %>%
  summarise(amount_sum = abs(sum(amount)),
            amount_mean = abs(mean(amount)),
            amount_median = abs(median(amount)),
            n = n()) %>%
  arrange(amount_sum)

merged_candidate <- merge(mdata.by_candidate, mdata.by_candidate_refunds, by=c("cand_nm", "party"), all.x = TRUE)

# Renaming columns in the data to be less verbose
merged_candidate <- rename(merged_candidate,
                           c("amount_sum.x" = "c_amount_sum",
                             "amount_mean.x" = "c_amount_mean",
                             "amount_median.x" = "c_amount_median",
                             "n.x" = "c_count",
                             "amount_sum.y" = "r_amount_sum",
                             "amount_mean.y" = "r_amount_mean",
                             "amount_median.y" = "r_amount_median",
                             "n.y" = "r_count"))

# Higher the ratio the better
merged_candidate$total_ratio <- merged_candidate$c_amount_sum / merged_candidate$r_amount_sum
merged_candidate$count_ratio <- merged_candidate$c_count / merged_candidate$r_count

# Removing redundant dataframes
remove(mdata.by_candidate, mdata.by_candidate_refunds)

```

#### Contributions

From the bar charts and tables of data, we can see that Hilary Clinton had the highest contributions amount (approx $65MM) followed by Bernie Sanders ($8MM), with Jeb Bush, Rubio Marco, Donald Trump and Ted Cruz raising between $3.5MM - $2MM. We can also see that most candidates raised less than $1MM in donations (13 out of 19).

```{r echo=FALSE, Candidate_Contributions}
ggplot(merged_candidate, aes(cand_nm, c_amount_sum, fill = cand_nm)) + 
  geom_bar(stat="identity") +
  xlab("Candidate") +
  ylab("Total Contributions") +
  ggtitle("2016 US Election Total Contributions by Candidate") +
  theme(axis.text.x=element_text(size=6)) +
  scale_y_continuous(breaks = seq(0, 70000000, 5000000))
```
Based on the large variance in the amounts raised by candidates, I decided to only focus on candidates who had raised more than $1MM. 

From the plots, you can see that Jeb Bush had the highest mean ($1591) and median ($2700) contributions. He also received the lowest frequency of contributions with only 2142 contributions. This is somewhat unusual as he had the third highest total contribution amount. **Jeb Bush contributors send him a lot of money but only a few times, who are they? i.e. are they large companies, or very rich individuals? Is this linked to the Bush Family?**

The next candidate with the highest mean ($668) and median ($100) by contribution is Marco Rubio. Again, he had a low frequency of contributions but had a relatively large contribution total. **This poses a similar questions - who are the contributors? i.e. are they large companies, or very rich individuals? Is this linked to a certain party?** 

The candidates with the lowest medians are Hilary Clinton and Bernie Sanders, although Hilary has the third highest mean. **Again, is this to do with their parties and the types of people that support them?**

```{r echo=FALSE, Candidate_Contributions_Means}
p1 <- ggplot(subset(merged_candidate, merged_candidate$c_amount_sum > 1000000), aes(cand_nm, c_amount_mean, fill = cand_nm)) + 
  geom_bar(stat="identity") +
  xlab("Candidate") +
  ylab("Mean Contribution") + 
  ggtitle("2016 US Election Mean Contribution by Candidate") +
  scale_y_continuous(breaks = seq(0, 1600, 100)) 

p2 <- ggplot(subset(merged_candidate, merged_candidate$c_amount_sum > 1000000), aes(cand_nm, c_amount_median, fill = cand_nm)) + 
  geom_bar(stat="identity") +
  xlab("Candidate") +
  ylab("Median Contribution") +
  ggtitle("2016 US Election Median Contribution by Candidate") +
  scale_y_continuous(breaks = seq(0, 2800, 100)) 

grid.arrange(p1,p2, ncol = 1)

subset(merged_candidate, merged_candidate$c_amount_sum > 1000000)[1:6]
```

#### Resignate/Refunds

From the barchart, we can see that Marco Rubio had the highest amount of refunds (approx $620K), followed by Hilary Clinton (approx $600K). They were followed by Bernie Sanders (approx $400K) and Ted Cruz (approx $375K). 

You can also see that various candidates had no refunds.

```{r echo=FALSE}
ggplot(merged_candidate, aes(cand_nm, r_amount_sum, fill = cand_nm)) + 
  geom_bar(stat="identity") +
  xlab("Candidate") +
  ylab("Total Contributions") +
  ggtitle("2016 US Election Total Refunds by Candidate") +
  theme(axis.text.x=element_text(size=6), legend.position = "none") +
  scale_y_continuous(breaks = seq(0, 650000, 50000))

subset(merged_candidate, !is.na(merged_candidate$r_count))[c(1,2,7:10)]

```

Looking at the mean bar chart, we can see that the highest mean is Scott Walker at $2961. He is followed by Lindsey Graham, Marco Rubio, John Kasich, Martin O'Malley and Jeb Bush who all had means above $1600.

The lowest mean refund was Hilary Clinton with $269 (excluding candidates with no refunds).

Looking at the median plot below, there is a distrubution where 6 candidates (Scott Walker, Lindsey Graham, Marco Rubio, John Kasich, Martin O'Malley and Jeb Bush) all had a median refund amount of $2700. **Why is this?**

The lowest median refunds were for Hilary Clinton and Ted Cruz at $50 (excluding candidates with no refunds).

```{r echo=FALSE, Candidate_Refunds}
p1 <- ggplot(merged_candidate, aes(cand_nm, r_amount_mean, fill = cand_nm)) + 
  geom_bar(stat="identity") +
  xlab("Candidate") +
  ylab("Mean Contribution") + 
  ggtitle("2016 US Election Mean Refund by Candidate") +
  theme(axis.text.x=element_text(size=6),  legend.position = "none") +
  scale_y_continuous(breaks = seq(0, 3000, 200))

p2 <- ggplot(merged_candidate, aes(cand_nm, r_amount_median, fill = cand_nm)) + 
  geom_bar(stat="identity") +
  xlab("Candidate") +
  ylab("Median Contribution") +
  ggtitle("2016 US Election Median Refund by Candidate") +
  theme(axis.text.x=element_text(size=6),  legend.position = "none") +
  scale_y_continuous(breaks = seq(0, 2800, 200))

grid.arrange(p1,p2, ncol = 1)

subset(merged_candidate, !is.na(merged_candidate$r_count))[c(1,2,7:10)]
```

To try and answer the median of $2700 question, I decided to plot the amount and see if there were any similarities. As can be seen from the graphs, they all had peaks at $2700.

I decided to look at the jobs the people had and found that most were in positions of management such as CEOs/COOs/CIO, Chairman, MDs, Executures, Investors, Managing Partner, Directors etc.

I also found that a lot had their money redignated to the general as opposed to refunded.

```{r echo=FALSE}
interesting_candidates <- subset(mdata, 
                                 mdata$cand_nm == "Bush, Jeb" |
                                 mdata$cand_nm == "Graham, Lindsey O." |
                                 mdata$cand_nm == "Kasich, John R." |
                                 mdata$cand_nm == "O'Malley, Martin Joseph" |
                                 mdata$cand_nm == "Rubio, Marco" |
                                 mdata$cand_nm == "Walker, Scott" )

qplot(x = abs(amount), data = subset(interesting_candidates, amount < 0)) +
  facet_wrap(~cand_nm, scales = "free") +
  xlab("Amount")

int_cand_2700 <- filter(interesting_candidates, amount == -2700)
head(summary(int_cand_2700$occupation),20)

remove(int_cand_2700)
```

#### Ratio of Resignate/Refunds to Contributions

As we were focused on candidates with more than $1MM in contributions, I have removed all candidates with less for this ratio.

From the Total Contributions barchart, we can see that the ratio is greatest for Hilary Clinton at 107 followed by Donald Trump at 44 with Jeb Bush and Bernie Sanders coming in with 21 and 22 respectively. Interestingly, both Ted Cruz and Marco Rubio had ratios less than 10, which implies that a large amount of the contributions were refunded. **Was this to do with them losing their election types? i.e. to do with timeframes**.

From the Number of Contributions barchart, we can see that Donald Trump has the highest ratio at 198. He is followed by Bernie Sanders at 149 and then Hilary Clinton at 90.

```{r echo=FALSE, Cand_Ratio}
p1 <- ggplot(subset(merged_candidate, merged_candidate$c_amount_sum > 1000000), aes(cand_nm, total_ratio, fill = cand_nm)) + 
  geom_bar(stat="identity") +
  xlab("Party") +
  ylab("Ratio") +
  ggtitle("2016 US Election Ratio of Total Contribution to Refunds Amount by Candidate") +
  theme(axis.text.x=element_text(size=6),  legend.position = "none") +
  scale_y_continuous(breaks = seq(0, 110, 10))

p2 <- ggplot(subset(merged_candidate, merged_candidate$c_amount_sum > 1000000), aes(cand_nm, count_ratio, fill = cand_nm)) + 
  geom_bar(stat="identity") +
  xlab("Party") +
  ylab("Ratio") +
  ggtitle("2016 US Election Ratio of Number of Contribution to Refunds by Candidate")+
  theme(axis.text.x=element_text(size=6),  legend.position = "none") +
  scale_y_continuous(breaks = seq(0, 200, 20))

grid.arrange(p1,p2, ncol=1)

subset(merged_candidate, merged_candidate$c_amount_sum > 1000000)[c(1,6,10,11:12)]
```

### Contributions and Resignate/Refunds by Gender

```{r echo=FALSE, Creating_table_for_gender}
mdata.by_gender <- subset(mdata, mdata$amount >= 0) %>%
  group_by(gender) %>%
  summarise(amount_sum = sum(amount),
            amount_mean = mean(amount),
            amount_median = median(amount),
            n = n()) %>%
  arrange(gender)

# With refunds
mdata.by_gender_refunds <- subset(mdata, mdata$amount < 0) %>%
  group_by(gender) %>%
  summarise(amount_sum = abs(sum(amount)),
            amount_mean = abs(mean(amount)),
            amount_median = abs(median(amount)),
            n = n()) %>%
  arrange(gender)

merged_gender <- merge(mdata.by_gender, mdata.by_gender_refunds, by="gender", all.x = TRUE)

# Renaming columns in the data to be less verbose
merged_gender <- rename(merged_gender,
                           c("amount_sum.x" = "c_amount_sum",
                             "amount_mean.x" = "c_amount_mean",
                             "amount_median.x" = "c_amount_median",
                             "n.x" = "c_count",
                             "amount_sum.y" = "r_amount_sum",
                             "amount_mean.y" = "r_amount_mean",
                             "amount_median.y" = "r_amount_median",
                             "n.y" = "r_count"))

# Higher the ratio the better
merged_gender$total_ratio <- merged_gender$c_amount_sum / merged_gender$r_amount_sum
merged_gender$count_ratio <- merged_gender$c_count / merged_gender$r_count

# Removing redundant dataframes
remove(mdata.by_gender, mdata.by_gender_refunds)
```

#### Contributions

From the charts, we can see that female candidates have almost 3 times higher total contributions than male candidates with ~$65MM to ~$23MM.

The mean contributions are again 3 times larger for females than for males at $320 to $101.

The median contributions are larger for females at $38 to males $27.

These results are especially suprising due to females only making up 2 of the 19 candidates. **Is it one particular candidate who is getting all the contributions for females? We know Hilary has the most contributions of any candidate by far.** 

```{r echo=FALSE, Gender_Contributions}
p1 <- ggplot(merged_gender, aes(gender, c_amount_sum, fill = gender)) + 
  geom_bar(stat="identity") +
  xlab("Gender") +
  ylab("Total Contributions") +
  ggtitle("2016 US Election Total Contributions by Gender") +
  scale_y_continuous(breaks = seq(0, 70000000, 10000000))

p2 <- ggplot(merged_gender, aes(gender, c_amount_mean, fill = gender)) + 
  geom_bar(stat="identity") +
  xlab("Gender") +
  ylab("Mean Contribution") +
  ggtitle("2016 US Election Mean Contribution by Gender")

p3 <- ggplot(merged_gender, aes(gender, c_amount_median, fill = gender)) + 
  geom_bar(stat="identity") +
  xlab("Gender") +
  ylab("Median Contribution") +
  ggtitle("2016 US Election Median Contribution by Gender")

grid.arrange(p1,p2,p3, ncol=1)

merged_gender[1:5]
```

#### Resignate/Refunds

The graphs show that males are getting more refunds by total amount, mean and median. 

As males and females have a frequency of contributions, this would suggest that large contributors are taking back large portions of money compared to female candidates contributors. **Can we prove this?**
```{r echo=FALSE, Gender_Refunds}
p1 <- ggplot(merged_gender, aes(gender, r_amount_sum, fill = gender)) + 
  geom_bar(stat="identity") +
  xlab("Gender") +
  ylab("Total Contributions") +
  ggtitle("2016 US Election Total Refunds by Gender") +
  scale_y_continuous(breaks = seq(0, 2000000, 250000))

p2 <- ggplot(merged_gender, aes(gender, r_amount_mean, fill = gender)) + 
  geom_bar(stat="identity") +
  xlab("Gender") +
  ylab("Mean Contribution") +
  ggtitle("2016 US Election Mean Refund by Gender")

p3 <- ggplot(merged_gender, aes(gender, r_amount_median, fill = gender)) + 
  geom_bar(stat="identity") +
  xlab("Gender") +
  ylab("Median Contribution") +
  ggtitle("2016 US Election Median Refunds by Gender")

grid.arrange(p1,p2,p3, ncol=1)

merged_gender[c(1,6:9)]
```

#### Ratio of Resignate/Refunds to Contributions

From the Total Contribution Ratio Barchart, it is clear that females had a much higher ratio of contribution amount to refund amount than males (107 to 11). 

From the Number of Contribution Barchart, we can see that they both had almost the same ratio of refunds to contributions as each other (90 to 92) however only <1% of total contributions were refunded for females compared ~10% for males. **Are larger donors getting refunds for males compared to females?**

To check this, I did another plot of the actual refunds and found that for females, there were many more refunds at lower values i.e. less than $500 whereas for males, there was almost as many refunds at $200 as there were at $2800. This further validates the theory that larger donors were Resignate/Refunding money from male candidates whereas smaller donors were Resignate/Refunding money from females.

```{r echo=FALSE}
p1 <- ggplot(merged_gender, aes(gender, total_ratio, fill = gender)) + 
  geom_bar(stat="identity") +
  xlab("Gender") +
  ylab("Ratio") +
  ggtitle("2016 US Election Ratio of Total Contribution to Refunds Amount by Gender") +
  scale_y_continuous(breaks = seq(0, 110, 10))

p2 <- ggplot(merged_gender, aes(gender, count_ratio, fill = gender)) + 
  geom_bar(stat="identity") +
  xlab("Gender") +
  ylab("Ratio") +
  ggtitle("2016 US Election Ratio of Number of Contribution to Refunds by Gender") +
  scale_y_continuous(breaks = seq(0, 100, 10))

grid.arrange(p1,p2, ncol=1)

merged_gender[c(1,5,9:11)]

qplot(x = abs(amount), data = subset(mdata, amount < 0)) +
  scale_x_continuous(limits = c(0, 4000), breaks = seq(0,4000,200)) +
  scale_y_continuous(limits = c(0 , 600)) +
  facet_wrap(~gender) +
  xlab("Refunds") +
  ylab("Count") +
  ggtitle("2016 US Election Ratio Refunds by Gender") 
```

## Bivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. How did the feature(s) of interest vary with other features in the dataset?

#### Relationship between Party and Amount

We can see that party contributions were in part influenced by where the donator was living such as large cities contributed to Republicans whereas smaller cities/towns contributed to Democrats. The amount in general was also influence by the party as the Democrats had a larger total of contributions compared to the other parties and had a higher frequency of contributions too. However the Republicans received more money per contribution.

The ratio of Contributions to Refunds/Redesignations is greater for the Democrats than it is for Republicans which shows they had less refunds/redesignations per contribution.

#### Relationship between Candidate and Amount

There was a clear relationship between candidates and their contribution amount which is as expected. Hilary Clinton had the highest contribution amount followed by Bernie Sanders. Most candidates did not raise more than $1M. Something of interest was that candidates had varying number of contributors but similar amounts of contribution, which may have something to do with their supporters incomes and their partys'.

For refunds/redesignations, there was a weird plot where 6 candidates had the same median refund amount. I looked further into this and found that these refunds/redesignations were from people who were in positions of management such as CEOs/COOs/CIO, Chairman, MDs, Executures, Investors, Managing Partner, Directors etc.

The ratio of Contributions to Refunds/Redesignations was greatest for Hilary Clinton. Candidates Ted Cruz and Marco Rubio both had ratios < 10 which implies a large amount of their contributions were refunded. I will look into this further to see if this was caused by them losing their election type.

### Did you observe any interesting relationships between the other features (not the main feature(s) of interest)?

#### Relationship between Zip and Amount

The relationship between zip and amount was not strong other than the largest donations come from large cities.

#### Relationship between Gender and Amount

Female candidates had almost 3 times higher total contributions, 3 times more mean contributions and larger median contributions than males. This was a little suprising as females made up only 2 of the 19 candidates.

Male candidates had more redisgnations/refunds by amount, mean and median. 

It was clear that females had a much higher ratio of contribution amount to refund amount than males yet had almost the same ratio of refunds to contributions, however only <1% of total contributions were refunded for females compared ~10% for males. 

This led me to believe that large contributors were taking back larger portions of their money for males compared to females. I did a plot of the actual refunds and found that for females, there were many more refunds at lower values. This further validates the theory that larger donors were Resignate/Refunding money from male candidates whereas smaller donors were Resignate/Refunding money from females.

### What was the strongest relationship you found?

The strongest relationship I found was between candidate and amount as a single candidate (Hilary Clinton) had the vast majority of contributions.

***

## Multivariate Plots Section

### Contributions and Resignate/Refunds by Party and Zip

From the silouhetter below, you have some indication that areas not in big cities were more likely to contribute for the Republicans whereas closer to big cities were more likely to contributre to Democrats.

```{r echo=FALSE}
# Drawing silouhette of NY with contributor data points
ggplot() +
  geom_polygon(data = newyork,
               aes(x = long, y = lat, group = group)) +
  geom_jitter(aes(x = longitude, y = latitude, group = NULL, color = party), 
             data = subset(mdata, 
                     !is.na(mdata$zip)),
             alpha = 1/50) +
  geom_point(data = subset(us.cities,
                           us.cities$country == "NY" & us.cities$pop > 100000),
             aes(x = long, y = lat, size = pop),
             colour = "green") +
  geom_text(data = subset(us.cities,
                          us.cities$country == "NY" & us.cities$pop > 100000),
            aes(x = long, y = lat, label = name),
            colour = "gold",
            fontface="bold")
```

## Multivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. Were there features that strengthened each other in terms of looking at your feature(s) of interest?

### Were there any interesting or surprising interactions between features?

### OPTIONAL: Did you create any models with your dataset? Discuss the strengths and limitations of your model.

***

# Final Plots and Summary

### Plot One
```{r echo=FALSE, Plot_One}

```

### Description One


### Plot Two
```{r echo=FALSE, Plot_Two}

```

### Description Two


### Plot Three
```{r echo=FALSE, Plot_Three}

```

### Description Three

***

# Reflection
I wanted to answer the question of whether if you come from a certain town, are you more likely to receive votes from that town.

